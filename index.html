<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Financial Insights - Portfolio Management</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* --- User-provided style.css --- */
        :root {
            --color-white: rgba(255, 255, 255, 1);
            --color-black: rgba(0, 0, 0, 1);
            --color-cream-50: rgba(252, 252, 249, 1);
            --color-cream-100: rgba(255, 255, 253, 1);
            --color-gray-200: rgba(245, 245, 245, 1);
            --color-gray-300: rgba(167, 169, 169, 1);
            --color-gray-400: rgba(119, 124, 124, 1);
            --color-slate-500: rgba(98, 108, 113, 1);
            --color-brown-600: rgba(94, 82, 64, 1);
            --color-charcoal-700: rgba(31, 33, 33, 1);
            --color-charcoal-800: rgba(38, 40, 40, 1);
            --color-slate-900: rgba(19, 52, 59, 1);
            --color-teal-300: rgba(50, 184, 198, 1);
            --color-teal-400: rgba(45, 166, 178, 1);
            --color-teal-500: rgba(33, 128, 141, 1);
            --color-teal-600: rgba(29, 116, 128, 1);
            --color-teal-700: rgba(26, 104, 115, 1);
            --color-teal-800: rgba(41, 150, 161, 1);
            --color-red-400: rgba(255, 84, 89, 1);
            --color-red-500: rgba(192, 21, 47, 1);
            --color-orange-400: rgba(230, 129, 97, 1);
            --color-orange-500: rgba(168, 75, 47, 1);
            --color-brown-600-rgb: 94, 82, 64;
            --color-teal-500-rgb: 33, 128, 141;
            --color-slate-900-rgb: 19, 52, 59;
            --color-slate-500-rgb: 98, 108, 113;
            --color-red-500-rgb: 192, 21, 47;
            --color-red-400-rgb: 255, 84, 89;
            --color-orange-500-rgb: 168, 75, 47;
            --color-orange-400-rgb: 230, 129, 97;
            --color-bg-1: rgba(59, 130, 246, 0.08);
            --color-bg-2: rgba(245, 158, 11, 0.08);
            --color-bg-3: rgba(34, 197, 94, 0.08);
            --color-bg-4: rgba(239, 68, 68, 0.08);
            --color-bg-5: rgba(147, 51, 234, 0.08);
            --color-bg-6: rgba(249, 115, 22, 0.08);
            --color-bg-7: rgba(236, 72, 153, 0.08);
            --color-bg-8: rgba(6, 182, 212, 0.08);
            --color-background: var(--color-cream-50);
            --color-surface: var(--color-cream-100);
            --color-text: var(--color-slate-900);
            --color-text-secondary: var(--color-slate-500);
            --color-primary: var(--color-teal-500);
            --color-primary-hover: var(--color-teal-600);
            --color-primary-active: var(--color-teal-700);
            --color-secondary: rgba(var(--color-brown-600-rgb), 0.12);
            --color-secondary-hover: rgba(var(--color-brown-600-rgb), 0.2);
            --color-secondary-active: rgba(var(--color-brown-600-rgb), 0.25);
            --color-border: rgba(var(--color-brown-600-rgb), 0.2);
            --color-btn-primary-text: var(--color-cream-50);
            --color-card-border: rgba(var(--color-brown-600-rgb), 0.12);
            --color-card-border-inner: rgba(var(--color-brown-600-rgb), 0.12);
            --color-error: var(--color-red-500);
            --color-success: var(--color-teal-500);
            --color-warning: var(--color-orange-500);
            --color-info: var(--color-slate-500);
            --color-focus-ring: rgba(var(--color-teal-500-rgb), 0.4);
            --color-select-caret: rgba(var(--color-slate-900-rgb), 0.8);
            --focus-ring: 0 0 0 3px var(--color-focus-ring);
            --focus-outline: 2px solid var(--color-primary);
            --status-bg-opacity: 0.15;
            --status-border-opacity: 0.25;
            --select-caret-light: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23134252' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            --select-caret-dark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23f5f5f5' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            --color-success-rgb: 33, 128, 141;
            --color-error-rgb: 192, 21, 47;
            --color-warning-rgb: 168, 75, 47;
            --color-info-rgb: 98, 108, 113;
            --font-family-base: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            --font-family-mono: "Berkeley Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
            --font-size-xs: 11px;
            --font-size-sm: 12px;
            --font-size-base: 14px;
            --font-size-md: 14px;
            --font-size-lg: 16px;
            --font-size-xl: 18px;
            --font-size-2xl: 20px;
            --font-size-3xl: 24px;
            --font-size-4xl: 30px;
            --font-weight-normal: 400;
            --font-weight-medium: 500;
            --font-weight-semibold: 550;
            --font-weight-bold: 600;
            --line-height-tight: 1.2;
            --line-height-normal: 1.5;
            --letter-spacing-tight: -0.01em;
            --space-0: 0;
            --space-1: 1px;
            --space-2: 2px;
            --space-4: 4px;
            --space-6: 6px;
            --space-8: 8px;
            --space-10: 10px;
            --space-12: 12px;
            --space-16: 16px;
            --space-20: 20px;
            --space-24: 24px;
            --space-32: 32px;
            --radius-sm: 6px;
            --radius-base: 8px;
            --radius-md: 10px;
            --radius-lg: 12px;
            --radius-full: 9999px;
            --shadow-xs: 0 1px 2px rgba(0, 0, 0, 0.02);
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.04), 0 1px 2px rgba(0, 0, 0, 0.02);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.04), 0 2px 4px -1px rgba(0, 0, 0, 0.02);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.04), 0 4px 6px -2px rgba(0, 0, 0, 0.02);
            --shadow-inset-sm: inset 0 1px 0 rgba(255, 255, 255, 0.15), inset 0 -1px 0 rgba(0, 0, 0, 0.03);
            --duration-fast: 150ms;
            --duration-normal: 250ms;
            --ease-standard: cubic-bezier(0.16, 1, 0.3, 1);
            --container-sm: 640px;
            --container-md: 768px;
            --container-lg: 1024px;
            --container-xl: 1280px;
        }
        html {
            font-size: var(--font-size-base);
            font-family: var(--font-family-base);
            line-height: var(--line-height-normal);
            color: var(--color-text);
            background-color: var(--color-background);
            -webkit-font-smoothing: antialiased;
            box-sizing: border-box;
        }
        body { margin: 0; padding: 0; }
        *, *::before, *::after { box-sizing: inherit; }
        h1, h2, h3, h4, h5, h6 {
            margin: 0;
            font-weight: var(--font-weight-semibold);
            line-height: var(--line-height-tight);
            color: var(--color-text);
            letter-spacing: var(--letter-spacing-tight);
        }
        h1 { font-size: var(--font-size-4xl); }
        h2 { font-size: var(--font-size-3xl); }
        h3 { font-size: var(--font-size-2xl); }
        h4 { font-size: var(--font-size-xl); }
        h5 { font-size: var(--font-size-lg); }
        h6 { font-size: var(--font-size-md); }
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: var(--space-8) var(--space-16);
            border-radius: var(--radius-base);
            font-size: var(--font-size-base);
            font-weight: 500;
            line-height: 1.5;
            cursor: pointer;
            transition: all var(--duration-normal) var(--ease-standard);
            border: none;
            text-decoration: none;
            position: relative;
        }
        .btn:focus-visible { outline: none; box-shadow: var(--focus-ring); }
        .btn--primary { background: var(--color-primary); color: var(--color-btn-primary-text); }
        .btn--primary:hover { background: var(--color-primary-hover); }
        .btn--primary:active { background: var(--color-primary-active); }
        .btn--secondary { background: var(--color-secondary); color: var(--color-text); }
        .btn--secondary:hover { background: var(--color-secondary-hover); }
        .btn--secondary:active { background: var(--color-secondary-active); }
        .btn--outline { background: transparent; border: 1px solid var(--color-border); color: var(--color-text); }
        .btn--outline:hover { background: var(--color-secondary); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .form-control {
            display: block;
            width: 100%;
            padding: var(--space-8) var(--space-12);
            font-size: var(--font-size-md);
            line-height: 1.5;
            color: var(--color-text);
            background-color: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-base);
            transition: border-color var(--duration-fast) var(--ease-standard), box-shadow var(--duration-fast) var(--ease-standard);
        }
        select.form-control {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: var(--select-caret-light);
            background-repeat: no-repeat;
            background-position: right var(--space-12) center;
            background-size: 16px;
            padding-right: var(--space-32);
        }
        .form-control:focus { border-color: var(--color-primary); outline: 0; box-shadow: var(--focus-ring); }
        .form-label { display: block; margin-bottom: var(--space-8); font-weight: var(--font-weight-medium); font-size: var(--font-size-sm); }
        .form-group { margin-bottom: var(--space-16); }
        .form-check-input:checked { background-color: var(--color-primary); border-color: var(--color-primary); }
        .form-check-label { font-size: var(--font-size-base); }
        .card {
            background-color: var(--color-surface);
            border-radius: var(--radius-lg);
            border: 1px solid var(--color-card-border);
            box-shadow: var(--shadow-sm);
            overflow: hidden;
            transition: box-shadow var(--duration-normal) var(--ease-standard);
        }
        .card:hover { box-shadow: var(--shadow-md); }
        .card-body, .card__body { padding: var(--space-20); }
        .card-header, .card__header { padding: var(--space-16) var(--space-20); border-bottom: 1px solid var(--color-card-border-inner); }
        .app-container { display: flex; min-height: 100vh; }
        .sidebar {
            width: 260px;
            background: var(--color-surface);
            border-right: 1px solid var(--color-border);
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            z-index: 1000;
            transition: transform var(--duration-normal) var(--ease-standard);
            overflow-y: auto;
        }
        .sidebar-header { padding: var(--space-24) var(--space-20); border-bottom: 1px solid var(--color-border); }
        .sidebar-header h4 { margin: 0; color: var(--color-primary); font-weight: var(--font-weight-bold); font-size: var(--font-size-xl); }
        .nav-links { list-style: none; padding: var(--space-16) 0; margin: 0; }
        .nav-links li { margin-bottom: var(--space-4); }
        .nav-link {
            display: flex;
            align-items: center;
            padding: var(--space-12) var(--space-20);
            color: var(--color-text-secondary);
            text-decoration: none;
            transition: all var(--duration-fast) var(--ease-standard);
            border-left: 3px solid transparent;
        }
        .nav-link:hover { background-color: var(--color-secondary); color: var(--color-text); text-decoration: none; }
        .nav-link.active { background-color: var(--color-secondary); color: var(--color-primary); border-left-color: var(--color-primary); }
        .nav-link i { width: 20px; margin-right: var(--space-12); }
        .mobile-menu-btn {
            position: fixed; top: var(--space-16); left: var(--space-16); z-index: 1001;
            background: var(--color-primary); color: var(--color-btn-primary-text); border: none;
            padding: var(--space-8) var(--space-12); border-radius: var(--radius-base);
            transition: all var(--duration-fast) var(--ease-standard);
        }
        .main-content {
            flex: 1;
            margin-left: 260px;
            padding: var(--space-24);
            background: var(--color-background);
            height: 100vh;
            overflow-y: auto;
        }
        .content-section { display: none; }
        .content-section.active { display: block; }
        .section-header { margin-bottom: var(--space-32); }
        .section-header h2 { margin-bottom: var(--space-8); color: var(--color-text); }
        .metric-card { border: 1px solid var(--color-card-border); transition: all var(--duration-normal) var(--ease-standard); height: 100%; }
        .metric-card:hover { box-shadow: var(--shadow-lg); transform: translateY(-2px); }
        .metric-icon { width: 48px; height: 48px; border-radius: var(--radius-base); display: flex; align-items: center; justify-content: center; color: white; }
        .metric-icon.bg-primary { background: var(--color-primary); }
        .metric-icon.bg-success { background: var(--color-success); }
        .metric-icon.bg-info { background: var(--color-info); }
        .table { margin-bottom: 0; }
        .table th { background-color: var(--color-bg-1); border-top: none; font-weight: var(--font-weight-semibold); color: var(--color-text); font-size: var(--font-size-sm); padding: var(--space-12) var(--space-16); }
        .table td { padding: var(--space-12) var(--space-16); vertical-align: middle; border-color: var(--color-border); }
        .table-hover tbody tr:hover { background-color: var(--color-bg-1); color: var(--color-text); }
        .gain-positive { color: var(--color-success) !important; font-weight: var(--font-weight-medium); }
        .gain-negative { color: var(--color-error) !important; font-weight: var(--font-weight-medium); }
        .insight-card { background: var(--color-surface); border: 1px solid var(--color-card-border); border-radius: var(--radius-lg); padding: var(--space-20); transition: all var(--duration-normal) var(--ease-standard); height: 100%; }
        .insight-card:hover { box-shadow: var(--shadow-md); transform: translateY(-2px); }
        .insight-header { display: flex; align-items: center; margin-bottom: var(--space-12); }
        .insight-icon { width: 40px; height: 40px; border-radius: var(--radius-base); display: flex; align-items: center; justify-content: center; margin-right: var(--space-12); color: white; }
        .insight-icon.rebalance { background: var(--color-warning); }
        .insight-icon.performance { background: var(--color-success); }
        .insight-icon.risk { background: var(--color-info); }
        .insight-icon.opportunity { background: var(--color-teal-400); }
        .insight-icon.news { background: var(--color-slate-500); }
        .insight-title { font-weight: var(--font-weight-semibold); color: var(--color-text); margin: 0; }
        .insight-description { color: var(--color-text-secondary); margin: 0; line-height: var(--line-height-normal); }
        .modal-content { background: var(--color-surface); border: 1px solid var(--color-border); border-radius: var(--radius-lg); }
        .modal-header { background: var(--color-bg-3); border-bottom: 1px solid var(--color-border); }
        .modal-title { color: var(--color-text); font-weight: var(--font-weight-semibold); }
        .modal-body { max-height: 70vh; overflow-y: auto; }
        .empty-state { text-align: center; padding: 4rem 2rem; background: var(--color-surface); border-radius: var(--radius-lg); }
        .empty-state i { font-size: 4rem; color: var(--color-primary); margin-bottom: 1.5rem; }
        .empty-state h4 { font-weight: 600; margin-bottom: 0.5rem; }
        .empty-state p { color: var(--color-text-secondary); margin-bottom: 1.5rem; }
        #companyInfoCard { background-color: var(--color-bg-1); border: 1px solid var(--color-border); }
        .alert-success { color: var(--color-success); background-color: var(--color-bg-3); border-color: var(--color-success); }
        @media (max-width: 991.98px) {
            .sidebar { transform: translateX(-100%); }
            .sidebar.show { transform: translateX(0); }
            .main-content { margin-left: 0; padding: var(--space-16); padding-top: 70px; }
            .mobile-menu-btn { display: block !important; }
        }
        @media (min-width: 992px) { .mobile-menu-btn { display: none; } }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar Navigation -->
        <nav id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <h4><i class="fas fa-chart-pie me-2"></i>AI Finance</h4>
            </div>
            <ul class="nav-links">
                <li><a href="#" class="nav-link active" data-section="dashboard"><i class="fas fa-tachometer-alt"></i>Dashboard</a></li>
                <li><a href="#" class="nav-link" data-section="portfolio"><i class="fas fa-wallet"></i>Portfolio</a></li>
                <li><a href="#" class="nav-link" data-section="insights"><i class="fas fa-brain"></i>AI Insights</a></li>
                <li><a href="#" class="nav-link" data-section="preferences"><i class="fas fa-sliders-h"></i>Preferences</a></li>
            </ul>
        </nav>

        <!-- Mobile Menu Toggle -->
        <button class="mobile-menu-btn d-lg-none" id="mobileMenuBtn">
            <i class="fas fa-bars"></i>
        </button>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Section -->
            <section id="dashboard" class="content-section active">
                <div class="section-header">
                    <h2>Portfolio Dashboard</h2>
                    <p class="text-secondary">A real-time overview of your investment portfolio.</p>
                </div>
                <div id="dashboardContent">
                    <!-- Dynamic content will be rendered here -->
                </div>
            </section>

            <!-- Portfolio Section -->
            <section id="portfolio" class="content-section">
                 <div class="section-header d-flex justify-content-between align-items-center">
                    <div>
                        <h2>Portfolio Management</h2>
                        <p class="text-secondary">Detailed view of your current holdings.</p>
                    </div>
                    <button class="btn btn--primary" id="addInvestmentBtnPortfolio">
                        <i class="fas fa-plus me-2"></i>Add Investment
                    </button>
                </div>
                <div id="portfolioContent">
                     <!-- Dynamic content will be rendered here -->
                </div>
            </section>

            <!-- AI Insights Section -->
            <section id="insights" class="content-section">
                <div class="section-header">
                    <h2>AI Insights</h2>
                    <p class="text-secondary">Automated recommendations and analysis powered by AI.</p>
                </div>
                 <div class="d-flex gap-2 mb-4">
                    <button class="btn btn--primary" id="generateInsightsBtn">
                        <i class="fas fa-wand-magic-sparkles me-2"></i>✨ Analyze My Portfolio
                    </button>
                    <button class="btn btn--secondary" id="getNewsAnalysisBtn">
                        <i class="fas fa-newspaper me-2"></i>✨ Get Market News Analysis
                    </button>
                </div>
                <div id="insightsContainer" class="row">
                    <!-- AI insights will be rendered here -->
                </div>
            </section>
            
            <!-- Preferences Section -->
            <section id="preferences" class="content-section">
                <div class="section-header">
                    <h2>User Preferences</h2>
                    <p class="text-secondary">Customize your risk profile and goals to tailor AI suggestions.</p>
                </div>
                <div class="card">
                    <div class="card__body">
                        <form id="preferencesForm">
                            <div class="form-group">
                                <label for="riskTolerance" class="form-label">Risk Tolerance</label>
                                <select id="riskTolerance" class="form-control">
                                    <option value="Low">Low</option>
                                    <option value="Moderate">Moderate</option>
                                    <option value="High">High</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Investment Goals</label>
                                <div id="investmentGoals">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="Retirement" id="goalRetirement">
                                        <label class="form-check-label" for="goalRetirement">Retirement</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="Wealth Building" id="goalWealth">
                                        <label class="form-check-label" for="goalWealth">Wealth Building</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="Income Generation" id="goalIncome">
                                        <label class="form-check-label" for="goalIncome">Income Generation</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="Capital Preservation" id="goalPreservation">
                                        <label class="form-check-label" for="goalPreservation">Capital Preservation</label>
                                    </div>
                                </div>
                            </div>
                            <button type="submit" class="btn btn--primary">Save Preferences</button>
                        </form>
                        <div id="preferencesMessage" class="mt-3"></div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Modals -->
    <!-- Add/Edit Investment Modal -->
    <div class="modal fade" id="investmentModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="investmentModalTitle">Add New Investment</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="investmentForm">
                        <input type="hidden" id="investmentId">
                        <div class="form-group mb-3">
                            <label class="form-label">Symbol</label>
                            <div class="input-group">
                                <input type="text" class="form-control" id="investmentSymbol" required placeholder="e.g., AAPL">
                                <button class="btn btn--outline" type="button" id="getCompanyInfoBtn">
                                    <i class="fas fa-wand-magic-sparkles me-1"></i> ✨ Get Info
                                </button>
                            </div>
                        </div>
                        <div id="companyInfoCard" class="card p-3 mb-3 d-none">
                            <div id="companyInfoContent"></div>
                        </div>
                        <div class="form-group mb-3">
                            <label class="form-label">Company Name</label>
                            <input type="text" class="form-control" id="investmentName" required placeholder="e.g., Apple Inc.">
                        </div>
                        <div class="form-group mb-3">
                            <label class="form-label">Shares</label>
                            <input type="number" step="any" class="form-control" id="investmentShares" required placeholder="e.g., 10">
                        </div>
                        <div class="form-group mb-3">
                            <label class="form-label">Purchase Price</label>
                            <input type="number" step="0.01" class="form-control" id="investmentPrice" required placeholder="e.g., 150.25">
                        </div>
                        <div class="form-group mb-3">
                            <label class="form-label">Asset Type</label>
                            <select class="form-control" id="investmentType" required>
                                <option value="Stock">Stock</option>
                                <option value="ETF">ETF</option>
                                <option value="Bond">Bond</option>
                                <option value="Crypto">Cryptocurrency</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn--secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn--primary" id="saveInvestmentBtn">Save Investment</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div class="modal fade" id="deleteConfirmModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Confirm Deletion</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p>Are you sure you want to delete this holding? This action cannot be undone.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn--secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-danger" id="confirmDeleteBtn">Delete</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0"></script>
    <script>
    // --- Main Application Logic (app.js) --- //
    document.addEventListener('DOMContentLoaded', function() {

        // --- STATE MANAGEMENT --- //
        let appData = {};
        let holdingIdToDelete = null;
        const initialData = {
            user_profile: {
                name: "New User",
                risk_tolerance: "Moderate",
                investment_goals: ["Wealth Building"],
            },
            holdings: [],
            transactions: [],
            watchlist: [],
            insights: [
                {
                    type: "opportunity",
                    title: "Welcome to AI Finance!",
                    description: "Add your first investment to see your portfolio dashboard and generate personalized AI insights."
                }
            ],
            portfolio_performance: []
        };

        // --- DOM ELEMENTS --- //
        const sidebar = document.getElementById('sidebar');
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const navLinks = document.querySelectorAll('.nav-link');
        const contentSections = document.querySelectorAll('.content-section');
        const investmentModalEl = document.getElementById('investmentModal');
        const investmentModal = new bootstrap.Modal(investmentModalEl);
        const deleteConfirmModalEl = document.getElementById('deleteConfirmModal');
        const deleteConfirmModal = new bootstrap.Modal(deleteConfirmModalEl);

        // --- CHARTS --- //
        let allocationChart = null;
        let performanceChart = null;
        Chart.register(ChartDataLabels);

        // --- INITIALIZATION --- //
        function init() {
            loadStoredData();
            initializeNavigation();
            initializeEventListeners();
            renderAll();
        }

        function renderAll() {
            renderDashboard();
            renderPortfolio();
            renderInsights();
            renderPreferences();
        }

        // --- DATA PERSISTENCE --- //
        function loadStoredData() {
            const storedData = localStorage.getItem('aiFinanceAppData');
            if (storedData) {
                appData = JSON.parse(storedData);
            } else {
                appData = JSON.parse(JSON.stringify(initialData)); // Deep copy
            }
        }

        function saveData() {
            localStorage.setItem('aiFinanceAppData', JSON.stringify(appData));
        }

        // --- NAVIGATION --- //
        function initializeNavigation() {
            mobileMenuBtn.addEventListener('click', () => sidebar.classList.toggle('show'));

            navLinks.forEach(link => {
                link.addEventListener('click', e => {
                    e.preventDefault();
                    const section = link.getAttribute('data-section');
                    showSection(section);
                    sidebar.classList.remove('show');
                });
            });

            document.addEventListener('click', e => {
                if (!sidebar.contains(e.target) && !mobileMenuBtn.contains(e.target)) {
                    sidebar.classList.remove('show');
                }
            });
        }

        function showSection(sectionName) {
            contentSections.forEach(section => section.classList.remove('active'));
            document.getElementById(sectionName)?.classList.add('active');
            
            navLinks.forEach(l => l.classList.remove('active'));
            document.querySelector(`.nav-link[data-section="${sectionName}"]`)?.classList.add('active');
        }

        // --- EVENT LISTENERS --- //
        function initializeEventListeners() {
            document.addEventListener('click', (e) => {
                if(e.target.matches('#addInvestmentBtnDashboard, #addInvestmentBtnPortfolio, #addInvestmentBtnEmpty')) {
                    openInvestmentModal();
                }
            });

            const portfolioContent = document.getElementById('portfolioContent');
            portfolioContent.addEventListener('click', (e) => {
                const editBtn = e.target.closest('.edit-btn');
                const deleteBtn = e.target.closest('.delete-btn');

                if (editBtn) {
                    const id = editBtn.dataset.id;
                    openInvestmentModal(parseInt(id));
                }
                if (deleteBtn) {
                    const id = deleteBtn.dataset.id;
                    holdingIdToDelete = parseInt(id);
                    deleteConfirmModal.show();
                }
            });

            document.getElementById('saveInvestmentBtn').addEventListener('click', handleSaveInvestment);
            document.getElementById('generateInsightsBtn').addEventListener('click', handlePortfolioAnalysis);
            document.getElementById('getNewsAnalysisBtn').addEventListener('click', handleNewsAnalysis);
            document.getElementById('getCompanyInfoBtn').addEventListener('click', handleGetCompanyInfo);
            document.getElementById('preferencesForm').addEventListener('submit', handleSavePreferences);
            
            document.getElementById('confirmDeleteBtn').addEventListener('click', () => {
                if (holdingIdToDelete !== null) {
                    appData.holdings = appData.holdings.filter(h => h.id !== holdingIdToDelete);
                    holdingIdToDelete = null; // Reset
                    updatePortfolioMetrics();
                    saveData();
                    renderAll();
                    deleteConfirmModal.hide();
                }
            });
        }

        // --- RENDERING FUNCTIONS --- //

        function renderDashboard() {
            const container = document.getElementById('dashboardContent');
            if (appData.holdings.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-chart-line"></i>
                        <h4>Your Dashboard is Ready</h4>
                        <p>Add your first investment to see your portfolio's value, performance, and allocation.</p>
                        <button class="btn btn--primary" id="addInvestmentBtnEmpty">
                            <i class="fas fa-plus me-2"></i>Add First Investment
                        </button>
                    </div>`;
                return;
            }

            updatePortfolioMetrics();
            const { total_portfolio_value, daily_change, daily_change_percent } = appData.user_profile;
            const changeClass = daily_change >= 0 ? 'gain-positive' : 'gain-negative';
            const changeSign = daily_change >= 0 ? '+' : '';

            container.innerHTML = `
                <div class="row">
                    <div class="col-md-4 mb-3">
                        <div class="card metric-card">
                            <div class="card__body d-flex justify-content-between align-items-center"><div><h6>Total Portfolio Value</h6><h3 class="text-primary">${formatCurrency(total_portfolio_value)}</h3></div><div class="metric-icon bg-primary"><i class="fas fa-dollar-sign"></i></div></div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-3">
                        <div class="card metric-card">
                            <div class="card__body d-flex justify-content-between align-items-center"><div><h6>Today's Change</h6><h3 class="${changeClass}">${changeSign}${formatCurrency(daily_change)} (${changeSign}${daily_change_percent.toFixed(2)}%)</h3></div><div class="metric-icon ${daily_change >= 0 ? 'bg-success' : 'bg-danger'}"><i class="fas ${daily_change >= 0 ? 'fa-trending-up' : 'fa-trending-down'}"></i></div></div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-3">
                        <div class="card metric-card">
                            <div class="card__body d-flex justify-content-between align-items-center"><div><h6>Total Holdings</h6><h3 class="text-info">${appData.holdings.length}</h3></div><div class="metric-icon bg-info"><i class="fas fa-list"></i></div></div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-6 mb-4">
                        <div class="card"><div class="card__body"><h5 class="card-title">Portfolio Allocation</h5><div style="position: relative; height: 300px;"><canvas id="allocationChart"></canvas></div></div></div>
                    </div>
                    <div class="col-lg-6 mb-4">
                        <div class="card"><div class="card__body"><h5 class="card-title">Portfolio Performance</h5><div style="position: relative; height: 300px;"><canvas id="performanceChart"></canvas></div></div></div>
                    </div>
                </div>
            `;
            initializeCharts();
        }

        function renderPortfolio() {
            const container = document.getElementById('portfolioContent');
             if (appData.holdings.length === 0) {
                container.innerHTML = `<p class="text-center text-muted mt-4">No investments added yet. Click "Add Investment" to start.</p>`;
                return;
            }
            const holdingsRows = appData.holdings.map(h => {
                const gainLossClass = h.gain_loss >= 0 ? 'gain-positive' : 'gain-negative';
                const gainLossSign = h.gain_loss >= 0 ? '+' : '';
                return `
                    <tr>
                        <td><strong>${h.symbol}</strong><br><small class="text-muted">${h.name}</small></td>
                        <td>${h.shares}</td>
                        <td>${formatCurrency(h.current_price)}</td>
                        <td>${formatCurrency(h.total_value)}</td>
                        <td class="${gainLossClass}">
                            ${gainLossSign}${formatCurrency(h.gain_loss)}
                            (${gainLossSign}${h.gain_loss_percent.toFixed(2)}%)
                        </td>
                        <td><span class="badge rounded-pill text-bg-light">${h.asset_type}</span></td>
                        <td>
                            <button class="btn btn--secondary btn-sm edit-btn" data-id="${h.id}"><i class="fas fa-edit"></i></button>
                            <button class="btn btn--secondary btn-sm delete-btn" data-id="${h.id}"><i class="fas fa-trash"></i></button>
                        </td>
                    </tr>
                `;
            }).join('');

            container.innerHTML = `
                <div class="card">
                    <div class="card__body p-0">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead><tr><th>Symbol</th><th>Shares</th><th>Current Price</th><th>Total Value</th><th>Gain/Loss</th><th>Type</th><th>Actions</th></tr></thead>
                                <tbody>${holdingsRows}</tbody>
                            </table>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function renderInsights() {
            const container = document.getElementById('insightsContainer');
            const insightsCards = appData.insights.map(insight => {
                const iconMap = { rebalance: 'fa-balance-scale', performance: 'fa-chart-line', risk: 'fa-shield-alt', opportunity: 'fa-lightbulb', news: 'fa-newspaper' };
                const iconClass = iconMap[insight.type] || 'fa-info-circle';
                const typeClass = insight.type || 'default';

                return `
                <div class="col-md-6 col-lg-4 mb-4">
                    <div class="insight-card">
                        <div class="insight-header">
                            <div class="insight-icon ${typeClass}"><i class="fas ${iconClass}"></i></div>
                            <h6 class="insight-title">${insight.title}</h6>
                        </div>
                        <p class="insight-description">${insight.description}</p>
                    </div>
                </div>
                `;
            }).join('');
            container.innerHTML = insightsCards.length > 0 ? insightsCards : '<p class="text-center text-muted">No insights available. Generate new insights based on your portfolio.</p>';
        }

        function renderPreferences() {
            document.getElementById('riskTolerance').value = appData.user_profile.risk_tolerance;
            const goals = appData.user_profile.investment_goals || [];
            document.querySelectorAll('#investmentGoals .form-check-input').forEach(checkbox => {
                checkbox.checked = goals.includes(checkbox.value);
            });
        }

        // --- CHARTING --- //
        function initializeCharts() {
            initializeAllocationChart();
            initializePerformanceChart();
        }

        function initializeAllocationChart() {
            const ctx = document.getElementById('allocationChart')?.getContext('2d');
            if (!ctx) return;
            
            const allocation = {};
            appData.holdings.forEach(h => {
                allocation[h.asset_type] = (allocation[h.asset_type] || 0) + h.total_value;
            });

            if (allocationChart) allocationChart.destroy();
            allocationChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: Object.keys(allocation),
                    datasets: [{
                        data: Object.values(allocation),
                        backgroundColor: ['#2196F3', '#4CAF50', '#FFC107', '#E91E63', '#9C27B0'],
                        borderWidth: 2,
                        borderColor: 'var(--color-surface)'
                    }]
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false, 
                    plugins: { 
                        legend: { display: false },
                        datalabels: {
                            formatter: (value, ctx) => {
                                const datapoints = ctx.chart.data.datasets[0].data;
                                const total = datapoints.reduce((total, datapoint) => total + datapoint, 0);
                                const percentage = (value / total * 100).toFixed(1);
                                return `${ctx.chart.data.labels[ctx.dataIndex]}\n${percentage}%`;
                            },
                            color: '#fff',
                            font: {
                                weight: 'bold',
                                size: 12,
                            },
                            textShadowColor: 'rgba(0,0,0,0.3)',
                            textShadowBlur: 4,
                        }
                    } 
                }
            });
        }

        function initializePerformanceChart() {
             const ctx = document.getElementById('performanceChart')?.getContext('2d');
            if (!ctx) return;

            if (appData.portfolio_performance.length === 0 && appData.holdings.length > 0) {
                 appData.portfolio_performance = generateDummyPerformance(appData.user_profile.total_portfolio_value);
            }

            const labels = appData.portfolio_performance.map(item => item.month);
            const data = appData.portfolio_performance.map(item => item.value);

            if (performanceChart) performanceChart.destroy();
            performanceChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Portfolio Value',
                        data: data,
                        borderColor: 'var(--color-primary)',
                        borderWidth: 3,
                        fill: false, // Changed from true to false
                        tension: 0, // Changed from 0.4 to 0 for straight lines
                        pointRadius: 4,
                        pointBackgroundColor: 'var(--color-primary)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { 
                        legend: { display: false },
                        datalabels: {
                            display: false // Hide data labels for line chart
                        }
                    },
                    scales: { y: { ticks: { callback: value => formatCurrency(value) } } }
                }
            });
        }
        
        function generateDummyPerformance(finalValue) {
            const data = [];
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'];
            let currentValue = finalValue * (0.8 + Math.random() * 0.1);
            const increment = (finalValue - currentValue) / (months.length -1);

            for(let i=0; i < months.length; i++) {
                data.push({
                    month: months[i],
                    value: Math.round(currentValue + (Math.random() - 0.5) * (finalValue * 0.05))
                });
                currentValue += increment;
            }
            data[months.length - 1].value = finalValue;
            return data;
        }


        // --- CORE LOGIC & HANDLERS --- //
        function openInvestmentModal(holdingId = null) {
            const form = document.getElementById('investmentForm');
            form.reset();
            const modalTitle = document.getElementById('investmentModalTitle');
            const investmentIdInput = document.getElementById('investmentId');
            document.getElementById('companyInfoCard').classList.add('d-none');
            document.getElementById('companyInfoContent').innerHTML = '';


            if (holdingId) {
                const holding = appData.holdings.find(h => h.id === holdingId);
                if (holding) {
                    modalTitle.textContent = 'Edit Investment';
                    investmentIdInput.value = holding.id;
                    document.getElementById('investmentSymbol').value = holding.symbol;
                    document.getElementById('investmentName').value = holding.name;
                    document.getElementById('investmentShares').value = holding.shares;
                    document.getElementById('investmentPrice').value = holding.purchase_price;
                    document.getElementById('investmentType').value = holding.asset_type;
                }
            } else {
                modalTitle.textContent = 'Add New Investment';
                investmentIdInput.value = '';
            }
            investmentModal.show();
        }

        function handleSaveInvestment() {
            const investmentId = document.getElementById('investmentId').value ? parseInt(document.getElementById('investmentId').value) : null;
            
            const holdingData = {
                symbol: document.getElementById('investmentSymbol').value.toUpperCase(),
                name: document.getElementById('investmentName').value,
                shares: parseFloat(document.getElementById('investmentShares').value),
                purchase_price: parseFloat(document.getElementById('investmentPrice').value),
                asset_type: document.getElementById('investmentType').value,
            };
            
            if(!holdingData.symbol || !holdingData.name || !holdingData.shares || !holdingData.purchase_price) {
                alert("Please fill all required fields.");
                return;
            }

            if (investmentId) {
                const index = appData.holdings.findIndex(h => h.id === investmentId);
                if (index > -1) {
                    const existingHolding = appData.holdings[index];
                    const updatedHolding = { ...existingHolding, ...holdingData };
                    
                    updatedHolding.total_value = updatedHolding.shares * updatedHolding.current_price;
                    updatedHolding.gain_loss = (updatedHolding.current_price - updatedHolding.purchase_price) * updatedHolding.shares;
                    updatedHolding.gain_loss_percent = (updatedHolding.purchase_price * updatedHolding.shares) > 0 ? (updatedHolding.gain_loss / (updatedHolding.purchase_price * updatedHolding.shares)) * 100 : 0;
                    
                    appData.holdings[index] = updatedHolding;
                }
            } else {
                const newHolding = {
                    id: Date.now(),
                    ...holdingData,
                    current_price: holdingData.purchase_price * (1 + (Math.random() - 0.4) * 0.2)
                };
                newHolding.total_value = newHolding.shares * newHolding.current_price;
                newHolding.gain_loss = (newHolding.current_price - newHolding.purchase_price) * newHolding.shares;
                newHolding.gain_loss_percent = (newHolding.purchase_price * newHolding.shares) > 0 ? (newHolding.gain_loss / (newHolding.purchase_price * newHolding.shares)) * 100 : 0;
                appData.holdings.push(newHolding);
                
                appData.transactions.unshift({
                    id: Date.now(),
                    date: new Date().toISOString().split('T')[0],
                    symbol: newHolding.symbol,
                    type: 'Buy',
                    shares: newHolding.shares,
                    price: newHolding.purchase_price,
                    total: newHolding.shares * newHolding.purchase_price
                });
            }

            updatePortfolioMetrics();
            saveData();
            renderAll();
            investmentModal.hide();
        }
        
        function handleSavePreferences(e) {
            e.preventDefault();
            appData.user_profile.risk_tolerance = document.getElementById('riskTolerance').value;
            
            const selectedGoals = [];
            document.querySelectorAll('#investmentGoals .form-check-input:checked').forEach(checkbox => {
                selectedGoals.push(checkbox.value);
            });
            appData.user_profile.investment_goals = selectedGoals;
            
            saveData();

            const msgEl = document.getElementById('preferencesMessage');
            msgEl.innerHTML = `<div class="alert alert-success" role="alert">Preferences saved successfully!</div>`;
            setTimeout(() => msgEl.innerHTML = '', 3000);
        }

        function updatePortfolioMetrics() {
            const totalValue = appData.holdings.reduce((sum, h) => sum + h.total_value, 0);
            const totalGainLoss = appData.holdings.reduce((sum, h) => sum + h.gain_loss, 0);
            const totalInvested = appData.holdings.reduce((sum, h) => sum + (h.purchase_price * h.shares), 0);
            
            appData.user_profile.total_portfolio_value = totalValue;
            appData.user_profile.daily_change = totalGainLoss;
            appData.user_profile.daily_change_percent = totalInvested > 0 ? (totalGainLoss / totalInvested) * 100 : 0;
        }

        // --- GEMINI API HANDLERS --- //
        
        async function handleGetCompanyInfo() {
            const symbol = document.getElementById('investmentSymbol').value;
            if (!symbol) {
                alert("Please enter a stock symbol first.");
                return;
            }

            const btn = document.getElementById('getCompanyInfoBtn');
            const originalText = btn.innerHTML;
            btn.innerHTML = `<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>`;
            btn.disabled = true;

            const prompt = `Provide a one-paragraph summary for the company with the stock symbol "${symbol}". Also provide its official "companyName". Format the output as a single JSON object with keys "companyName" and "summary".`;
            
            const infoCard = document.getElementById('companyInfoCard');
            const infoContent = document.getElementById('companyInfoContent');

            try {
                const result = await generateContent(prompt, {
                    responseMimeType: "application/json",
                    responseSchema: {
                        type: "OBJECT",
                        properties: {
                            "companyName": { "type": "STRING" },
                            "summary": { "type": "STRING" }
                        },
                        required: ["companyName", "summary"]
                    }
                });
                
                document.getElementById('investmentName').value = result.companyName;
                infoContent.innerHTML = `<h6 class="card-title">${result.companyName}</h6><p class="card-text small">${result.summary}</p>`;
                infoCard.classList.remove('d-none');

            } catch (error) {
                console.error("Error fetching company info:", error);
                infoContent.innerHTML = `<p class="card-text text-danger">Could not fetch info for symbol "${symbol}". Please check the symbol and try again.</p>`;
                infoCard.classList.remove('d-none');
            } finally {
                btn.innerHTML = originalText;
                btn.disabled = false;
            }
        }

        async function handlePortfolioAnalysis() {
            const btn = document.getElementById('generateInsightsBtn');
            const originalText = btn.innerHTML;
            btn.innerHTML = `<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Analyzing...`;
            btn.disabled = true;

            const portfolioSummary = `
                Analyze the following investment portfolio and provide 3-4 actionable insights.
                The user's risk tolerance is "${appData.user_profile.risk_tolerance}" and their goals are "${appData.user_profile.investment_goals.join(', ')}".
                Total Portfolio Value: ${formatCurrency(appData.user_profile.total_portfolio_value)}.
                Holdings:
                ${appData.holdings.map(h => `- ${h.shares} shares of ${h.symbol} (${h.name}), type: ${h.asset_type}, current value: ${formatCurrency(h.total_value)}`).join('\n')}
                
                For each insight, provide a 'type' (one of: rebalance, performance, risk, opportunity), a short 'title', and a one-sentence 'description'.
                Format the output as a JSON array of objects.
            `;
            
            try {
                const newInsights = await generateContent(portfolioSummary, {
                    responseMimeType: "application/json",
                    responseSchema: {
                      type: "ARRAY",
                      items: {
                        type: "OBJECT",
                        properties: {
                          "type": { "type": "STRING" },
                          "title": { "type": "STRING" },
                          "description": { "type": "STRING" }
                        },
                        required: ["type", "title", "description"]
                      }
                    }
                });
                appData.insights = newInsights;
                saveData();
                renderInsights();
            } catch (error) {
                console.error("Error generating insights:", error);
                appData.insights.unshift({ type: 'risk', title: 'Error', description: 'Could not generate portfolio insights at this time. Please try again later.' });
                renderInsights();
            } finally {
                btn.innerHTML = originalText;
                btn.disabled = false;
            }
        }

        async function handleNewsAnalysis() {
            const btn = document.getElementById('getNewsAnalysisBtn');
            const originalText = btn.innerHTML;
            btn.innerHTML = `<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Analyzing...`;
            btn.disabled = true;

            const prompt = `Act as a financial analyst. Provide a summary of the top 3-4 financial news headlines for today. For each, briefly explain the potential impact on the market. Present each as an insight with a 'type' of "news", a 'title' from the headline, and a 'description' with the analysis. Format as a JSON array of objects.`;

            try {
                const newsInsights = await generateContent(prompt, {
                    responseMimeType: "application/json",
                    responseSchema: {
                      type: "ARRAY",
                      items: {
                        type: "OBJECT",
                        properties: {
                          "type": { "type": "STRING" },
                          "title": { "type": "STRING" },
                          "description": { "type": "STRING" }
                        },
                        required: ["type", "title", "description"]
                      }
                    }
                });
                appData.insights = [...newsInsights, ...appData.insights.filter(i => i.type !== 'news')];
                saveData();
                renderInsights();
            } catch (error) {
                console.error("Error generating news analysis:", error);
                 appData.insights.unshift({ type: 'risk', title: 'Error', description: 'Could not generate news analysis at this time. Please try again later.' });
                renderInsights();
            } finally {
                btn.innerHTML = originalText;
                btn.disabled = false;
            }
        }

        async function generateContent(prompt, generationConfig = {}) {
            // The URL now points to YOUR secure Cloud Function
            const url = 'https://us-central1-gen-lang-client-0367955800.cloudfunctions.net/apiProxy/handler'; 

            const payload = {
              contents: [{ parts: [{ text: prompt }] }],
              generationConfig
            };

            // The 'body' of the request is now the full payload
            const response = await fetch(url, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload) 
            });

            if (!response.ok) {
                const errorBody = await response.text();
                console.error("API Error Response:", errorBody);
                throw new Error(`API call failed with status: ${response.status}`);
            }

            const result = await response.json();
            
            const candidate = result?.candidates?.[0];
            const part = candidate?.content?.parts?.[0];

            if (!part || !part.text) {
                console.error("Invalid API response structure:", JSON.stringify(result, null, 2));
                throw new Error("Invalid response from API: No text part found.");
            }
            const text = part.text;
            return JSON.parse(text);
        }

        // --- UTILITY FUNCTIONS --- //
        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(amount || 0);
        }

        // --- START THE APP --- //
        init();
    });
    </script>
</body>
</html>

